\documentclass[11pt]{report}
 
\usepackage{ragged2e}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{changepage}
\usepackage{longtable}

\graphicspath{ {hw1-data/} }

\begin{document}

\title{COMS 4721: Machine Learning for Data Science 
Home work 4}
\author{Chao Pang}
 
\maketitle

\section* {Problem 1 (Markov chains)}
a) Use ${w_t}$ to rank the teams by sorting in decreasing value according to this vector. List the top 25 team names (see accompanying file) and their corresponding values in ${w_t}$ for $t = 10; 100; 1000; 10000$.
\justify Solution: The rankings generated using different $W_{t}$ are presented in the below tables, where the corresponding $W_{t}$ is shown in the header. $W_{1000}$ and $W_{10000}$ have almost the same rankings except that the 21st and 22nd teams are swapped (NorthDakotaSt and Navy). During calculation, $W_{0}$ was set to a uniform distribution and after a certain number of the steps, $W_{t}$ was approaching the stationary distribution.

\justify
\resizebox{13cm}{!}{

\begin{tabular}{rlr}
\toprule
  \multicolumn{3}{c}{Rankings generated by $W_{10}$} \\
\toprule
  Rank &              Team &  Probability \\
\midrule
    1 &      NorthCentral &       0.0128 \\
    2 &               LSU &       0.0126 \\
    3 &       Morningside &       0.0115 \\
    4 &           Wheaton &       0.0111 \\
    5 &    MinnSt-Mankato &       0.0096 \\
    6 &        Muhlenberg &       0.0095 \\
    7 &         OhioState &       0.0092 \\
    8 &     UW-Whitewater &       0.0092 \\
    9 &     NorthDakotaSt &       0.0091 \\
   10 &           Clemson &       0.0089 \\
   11 &       WestFlorida &       0.0088 \\
   12 &          MarianIN &       0.0085 \\
   13 &         StJohnsMN &       0.0085 \\
   14 &        MountUnion &       0.0077 \\
   15 &          FerrisSt &       0.0071 \\
   16 &         GrandView &       0.0071 \\
   17 &           Georgia &       0.0070 \\
   18 & MaryHardin-Baylor &       0.0068 \\
   19 &      Lenoir-Rhyne &       0.0062 \\
   20 &      SlipperyRock &       0.0061 \\
   21 &            Oregon &       0.0059 \\
   22 &    DelawareValley &       0.0058 \\
   23 &      JamesMadison &       0.0057 \\
   24 &        ValdostaSt &       0.0055 \\
   25 &           Florida &       0.0054 \\
\bottomrule
\end{tabular}

\quad

\begin{tabular}{llr}
\toprule
  \multicolumn{3}{c}{Rankings generated by $W_{100}$} \\
\toprule
 Rank &           Team &  Probability \\
\midrule
    1 &            LSU &       0.0436 \\
    2 &        Wheaton &       0.0258 \\
    3 &   NorthCentral &       0.0244 \\
    4 &        Clemson &       0.0237 \\
    5 &      OhioState &       0.0227 \\
    6 &    Morningside &       0.0226 \\
    7 &        Georgia &       0.0172 \\
    8 &      StJohnsMN &       0.0150 \\
    9 &    WestFlorida &       0.0134 \\
   10 &        Alabama &       0.0129 \\
   11 &  UW-Whitewater &       0.0128 \\
   12 &        Florida &       0.0124 \\
   13 &     Muhlenberg &       0.0112 \\
   14 &         Oregon &       0.0105 \\
   15 &         Auburn &       0.0100 \\
   16 &       Oklahoma &       0.0100 \\
   17 & MinnSt-Mankato &       0.0098 \\
   18 &       MarianIN &       0.0096 \\
   19 &      PennState &       0.0095 \\
   20 &     ValdostaSt &       0.0089 \\
   21 &   Lenoir-Rhyne &       0.0081 \\
   22 &      Wisconsin &       0.0080 \\
   23 &      NotreDame &       0.0079 \\
   24 &      Minnesota &       0.0075 \\
   25 &      GrandView &       0.0075 \\
\bottomrule
\end{tabular}
}

\pagebreak

\resizebox{13cm}{!}{

\begin{tabular}{rlr}
\toprule
  \multicolumn{3}{c}{Rankings generated by $W_{1000}$} \\
\toprule
 Rank &          Team &  Probability \\
\midrule
    1 &           LSU &       0.0844 \\
    2 &       Clemson &       0.0455 \\
    3 &     OhioState &       0.0435 \\
    4 &       Georgia &       0.0327 \\
    5 &       Alabama &       0.0247 \\
    6 &       Florida &       0.0237 \\
    7 &        Oregon &       0.0193 \\
    8 &        Auburn &       0.0190 \\
    9 &      Oklahoma &       0.0187 \\
   10 &     PennState &       0.0180 \\
   11 &     Wisconsin &       0.0152 \\
   12 &     NotreDame &       0.0146 \\
   13 &     Minnesota &       0.0142 \\
   14 &        Baylor &       0.0127 \\
   15 &      Michigan &       0.0120 \\
   16 &          Utah &       0.0117 \\
   17 &       Memphis &       0.0117 \\
   18 &          Iowa &       0.0110 \\
   19 & AppalachianSt &       0.0109 \\
   20 &         Texas &       0.0102 \\
   21 & NorthDakotaSt &       0.0092 \\
   22 &          Navy &       0.0091 \\
   23 &      TexasA\&M &       0.0089 \\
   24 &       BoiseSt &       0.0083 \\
   25 &      KansasSt &       0.0073 \\
\bottomrule
\end{tabular}

\quad

\begin{tabular}{llr}
\toprule
  \multicolumn{3}{c}{Rankings generated by $W_{10000}$} \\
\toprule
 Rank &          Team &  Probability \\
\midrule
    1 &           LSU &       0.0914 \\
    2 &       Clemson &       0.0493 \\
    3 &     OhioState &       0.0470 \\
    4 &       Georgia &       0.0354 \\
    5 &       Alabama &       0.0267 \\
    6 &       Florida &       0.0256 \\
    7 &        Oregon &       0.0208 \\
    8 &        Auburn &       0.0206 \\
    9 &      Oklahoma &       0.0202 \\
   10 &     PennState &       0.0194 \\
   11 &     Wisconsin &       0.0164 \\
   12 &     NotreDame &       0.0158 \\
   13 &     Minnesota &       0.0153 \\
   14 &        Baylor &       0.0137 \\
   15 &      Michigan &       0.0130 \\
   16 &          Utah &       0.0126 \\
   17 &       Memphis &       0.0126 \\
   18 &          Iowa &       0.0119 \\
   19 & AppalachianSt &       0.0118 \\
   20 &         Texas &       0.0110 \\
   21 &          Navy &       0.0098 \\
   22 & NorthDakotaSt &       0.0097 \\
   23 &      TexasA\&M &       0.0097 \\
   24 &       BoiseSt &       0.0089 \\
   25 &      KansasSt &       0.0079 \\
\bottomrule
\end{tabular}
}

\pagebreak

\justify 
b) Plot $||W_{t} - W_{\infty}||$ as a function of t for t = 1, ..., 10000.

\justify Solution: \textbf{Figure~\ref{fig:l1_norm}} shows the l1 norm is decreasing quickly and plateaued around 2000 iterations, and the last l1 norm is approximately $2.18\times10^{-4}$.

\begin{figure}[h]
\includegraphics[scale=0.4]{hw4-data/l1_norm.png}
\centering
\caption{L1 norm for $||W_{t} - W_{\infty}||$ }
\label{fig:l1_norm}
\end{figure}


\pagebreak

\section* {Problem 2 (Nonnegative matrix factorization)}
a) Implement and run the NMF algorithm on this data using the divergence penalty. Set the rank to 25 and run for 100 iterations. This corresponds to learning 25 topics. Plot the objective as a function of iteration.

\justify Solution: \textbf{Figure~\ref{fig:nmf_learning_objective}} shows the learning objective of running NMF using divergence penalty. It's worth mentioning the learning objective was calculated before the $W$ and $H$ matrices were updated for each iteration, however, the learning objective associated with the first iteration was omitted from the figure due to its incredibly large value  $\approx 1.4 \times 10^{9}$ because incorporating the first learning objective would "blow up" y-scale in the figure. Therefore, there were only 99 data points (excluding the first learning objective) in this figure instead of 100. Alternatively, one could think of this as calculating the learning objective after $W$ and $H$ matrices were updated for each iteration.

\begin{figure}[h]
\includegraphics[scale=0.4]{hw4-data/nmf_learning_objective.png}
\centering
\caption{Learning objective of NMF using the divergence penalty}
\label{fig:nmf_learning_objective}
\end{figure}

\justify b) For each column of W, list the 10 words having the largest weight and show the weight. Organize these lists in a 5 $\times$ 5 table on next page

\begin{table}[!hbt]
\centering
\scriptsize
\begin{tabular}{| l | l | l |l|l|}
\toprule \textbf{Topic 1} & \textbf{Topic 2} & \textbf{Topic 3} & \textbf{Topic 4} & \textbf{Topic 5} \\
                          \midrule man 0.0143 & company 0.0379 & team 0.0332 & life 0.0166 & student 0.0178 \\
                                       tell 0.014 & sell 0.0234 & game 0.0324 & book 0.0165 & school 0.0173 \\
                                  friend 0.0125 & sale 0.0204 & player 0.0269 & write 0.0122 & study 0.0088 \\
                                  woman 0.0116 & market 0.0188 & season 0.0248 & man 0.011 & college 0.0085 \\
                                 home 0.0116 & business 0.0171 & play 0.0205 & woman 0.0098 & editor 0.0084 \\
                                    child 0.0115 & buy 0.0141 & coach 0.0145 & world 0.0087 & article 0.008 \\
                           life 0.0114 & executive 0.0135 & league 0.0103 & story 0.0084 & education 0.0079 \\
                              live 0.0108 & share 0.0134 & baseball 0.0102 & love 0.0071 & professor 0.0073 \\
                               young 0.0104 & industry 0.0133 & ball 0.0082 & author 0.007 & program 0.0071 \\
                              family 0.0104 & price 0.0113 & football 0.0076 & family 0.0062 & class 0.0071 \\
                                                                                                &  &  &  &  \\
     \toprule \textbf{Topic 6} & \textbf{Topic 7} & \textbf{Topic 8} & \textbf{Topic 9} & \textbf{Topic 10} \\
                            \midrule health 0.0187 & art 0.0268 & states 0.0164 & town 0.0105 & case 0.0189 \\
                                 drug 0.0148 & artist 0.0164 & government 0.0145 & mile 0.01 & charge 0.017 \\
                                  care 0.013 & museum 0.0117 & official 0.0142 & park 0.0097 & lawyer 0.016 \\
                          doctor 0.0113 & exhibition 0.0105 & country 0.0142 & street 0.0094 & court 0.0155 \\
                                   medical 0.0107 & event 0.0099 & american 0.013 & city 0.0089 & law 0.014 \\
                              patient 0.0098 & painting 0.0088 & leader 0.0092 & shop 0.0082 & judge 0.0101 \\
                child 0.0097 & photograph 0.0087 & international 0.0083 & open 0.008 & investigation 0.0094 \\
                            percent 0.0097 & american 0.0084 & agreement 0.0083 & area 0.008 & legal 0.0091 \\
                         treatment 0.009 & collection 0.008 & meeting 0.0072 & site 0.008 & official 0.0083 \\
                             program 0.0087 & gallery 0.0076 & foreign 0.0071 & place 0.0078 & trial 0.0081 \\
                                                                                                &  &  &  &  \\
 \toprule \textbf{Topic 11} & \textbf{Topic 12} & \textbf{Topic 13} & \textbf{Topic 14} & \textbf{Topic 15} \\
                             \midrule floor 0.0144 & music 0.0306 & water 0.0108 & thing 0.0137 & war 0.017 \\
                            wall 0.0131 & performance 0.0147 & plant 0.0089 & little 0.0123 & attack 0.0162 \\
                                   room 0.0121 & play 0.0137 & produce 0.0076 & big 0.012 & military 0.0144 \\
                                    wear 0.0117 & song 0.0128 & scientist 0.0075 & lot 0.0116 & kill 0.0141 \\
                                   color 0.0092 & perform 0.0126 & cause 0.0071 & put 0.0101 & force 0.0129 \\
                                  design 0.0084 & dance 0.012 & problem 0.0062 & hard 0.0099 & troop 0.0088 \\
                             window 0.0076 & sound 0.0104 & natural 0.0055 & really 0.0091 & soldier 0.0084 \\
                                    white 0.0075 & sing 0.0103 & expert 0.0054 & start 0.008 & peace 0.0076 \\
                                    house 0.0075 & band 0.0095 & research 0.0054 & far 0.008 & group 0.0074 \\
                                  glass 0.007 & concert 0.0092 & gas 0.0053 & feel 0.0075 & violence 0.0072 \\
                                   &  &  &  &  \\
 \toprule \textbf{Topic 16} & \textbf{Topic 17} & \textbf{Topic 18} & \textbf{Topic 19} & \textbf{Topic 20} \\
                    \midrule plan 0.0156 & percent 0.0247 & question 0.0135 & city 0.0231 & computer 0.0202 \\
                                    city 0.014 & rate 0.0144 & ask 0.0114 & official 0.0203 & company 0.016 \\
                                 project 0.0132 & rise 0.0126 & news 0.0105 & police 0.017 & service 0.0146 \\
                           building 0.0106 & economy 0.0105 & tell 0.0103 & yesterday 0.013 & system 0.0133 \\
                                 build 0.01 & price 0.0104 & speak 0.0089 & school 0.013 & technology 0.012 \\
                         pay 0.0098 & increase 0.0102 & interview 0.0084 & hour 0.0125 & information 0.0107 \\
                              money 0.0093 & market 0.0099 & issue 0.0073 & worker 0.0124 & internet 0.0091 \\
                                  community 0.009 & bank 0.0098 & believe 0.0072 & car 0.0104 & site 0.0084 \\
                                   area 0.0088 & fall 0.0089 & public 0.0071 & fire 0.01 & available 0.0079 \\
                               state 0.0086 & low 0.0086 & reporter 0.0071 & spokesman 0.0099 & cost 0.0073 \\
                                                                                                &  &  &  &  \\
 \toprule \textbf{Topic 21} & \textbf{Topic 22} & \textbf{Topic 23} & \textbf{Topic 24} & \textbf{Topic 25} \\
                        \midrule vote 0.0169 & food 0.0166 & television 0.0307 & mrs 0.0378 & second 0.0265 \\
                               campaign 0.0162 & fresh 0.0111 & film 0.0267 & president 0.0353 & win 0.0251 \\
                          political 0.0149 & serve 0.0101 & movie 0.0226 & graduate 0.0334 & victory 0.0173 \\
                               state 0.0133 & restaurant 0.0097 & play 0.019 & father 0.0324 & third 0.0173 \\
                             republican 0.0119 & pound 0.0095 & director 0.0142 & son 0.0265 & score 0.0166 \\
                          election 0.0112 & taste 0.0094 & audience 0.0134 & director 0.0231 & point 0.0144 \\
                                candidate 0.0111 & cook 0.0078 & star 0.0128 & retire 0.0228 & final 0.0126 \\
                                      party 0.0108 & eat 0.0077 & theater 0.0127 & vice 0.021 & play 0.0123 \\
                             leader 0.0094 & dinner 0.0077 & direct 0.0124 & daughter 0.021 & finish 0.0123 \\
                             democratic 0.0093 & add 0.0075 & production 0.0122 & name 0.0192 & lose 0.0115 \\
\bottomrule
\end{tabular}
\end{table}


\end{document}